<!doctype html>

<html>

  <head>

    <style>
      body { margin: 0; padding: 0; }




    </style>

    <script>
      function load () {
        (function (states) {
        console.log(states);
          (function (state) {

            (function (node) {
              document.body.childNodes.forEach(function (c) {
                node.appendChild(c);
              });
            })(document.createElement('node'));

            (function (node) {
              while (state.value.indexOf('@') === 0)
                state = states[state.value.substr(1)];

                node.innerHTML = '<' + state.name + '>' + state.value + '</' + state.name + '>';
            })(document.body);

          })(states['init'] || states[Object.keys(states)[0]]);

        })(
          (function (states) {
          console.log(states)
            return Object.keys(states).reduce(function (states, state) {
              states[state] = {name: state, value: states[state]};
              return states;
            }, states);
          })({
            'init': '@textMessage',

            'textMessage':
              '<textarea></textarea>'
          })
        );
      }
    </script>

  </head>

  <body onload="load()"></body>

</html>